(()=>{"use strict";const t=function(){function t(t,e,n,r){this._id=t,this._name=e,this._email=n,this._address=r}return t.prototype.id=function(){return this._id},t.prototype.name=function(){return this._name},t.prototype.email=function(){return this._email},t.prototype.address=function(){return this._address},t}(),e=function(){function t(){}return t.trigger=function(t){void 0!==this._subscribers[t.name()]&&this._subscribers[t.name()].forEach((function(e){e.invoke(t.name(),t.data())}))},t.subscribe=function(t,e){void 0!==this._subscribers[e]?this._subscribers[e].push(t):this._subscribers[e]=[t]},t._subscribers={},t}(),n=function(){function t(t,e){this._name=t,this._eventData=e}return t.prototype.name=function(){return this._name},t.prototype.data=function(){return this._eventData},t}(),r=function(){function t(t){this._data=t}return t.prototype.data=function(){return this._data},t}(),i=function(){function t(t){this._user=t}return t.prototype.buildHtmlElement=function(){var t=document.createElement("div");return t.innerHTML="\n\t\t\t\t".concat(this._user.id(),"\n\t\t\t\t").concat(this._user.name(),"\n\t\t\t\t").concat(this._user.email(),"\n\t\t\t\t").concat(this._user.address(),'\n\t\t\t\t<input type="checkbox" class="delete" name="userDelete" value="').concat(this._user.id(),'">\n\t\t\t'),t.appendChild(this._buildLinkEdit()),t},t.prototype._buildLinkEdit=function(){var t=document.createElement("a");return t.innerHTML="Edit",t.setAttribute("href","/"),t.addEventListener("click",(function(t){t.preventDefault(),e.trigger(new n("changePanel",new r("EditUser")))})),t},t}();const s=function(){function i(){this._form=document.createElement("form")}return i.prototype.buildHtmlElement=function(){var e=this;return this._form.innerHTML='\n\t\t\t\t<div>Name: <input class="name" required name="name"></div>\n\t\t\t\t<div>Email: <input class="email" required name="email"></div>\n\t\t\t\t<div>Address: <input class="address" required name="address"></div>\n\t\t\t\t<div><input type="submit"></div>\n\t\t\t',this._form.appendChild(this._buildLinkToList()),this._form.addEventListener("submit",(function(n){n.preventDefault();var r=e._form.querySelector(".name"),i=e._form.querySelector(".email"),s=e._form.querySelector(".address"),o=new t(0,r.value,i.value,s.value);e._createUser(o)})),this._form},i.prototype._buildLinkToList=function(){var t=document.createElement("a");return t.innerHTML="to List",t.setAttribute("href","/"),t.addEventListener("click",(function(t){t.preventDefault(),e.trigger(new n("changePanel",new r("UserList")))})),t},i.prototype._createUser=function(t){return e=this,n=void 0,i=function(){var e,n;return function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,(function(r){switch(r.label){case 0:return e={name:t.name(),email:t.email(),address:t.address()},[4,fetch("/users/create/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return(n=r.sent()).ok?[4,n.json()]:[3,3];case 2:return r.sent(),alert("User added"),[3,4];case 3:alert("Error HTTP: "+n.status),r.label=4;case 4:return[2]}}))},new((r=void 0)||(r=Promise))((function(t,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,a)}u((i=i.apply(e,n||[])).next())}));var e,n,r,i},i}();const o=function(){function i(t){this._user=t,this._form=document.createElement("form")}return i.prototype.buildHtmlElement=function(){var e=this;return this._form.innerHTML='\n\t\t\t\t<input type="hidden" class="id" name="id" value="'.concat(this._user.id(),'">\n\t\t\t\t<div>Name: <input class="name" required name="name" value="').concat(this._user.name(),'"></div>\n\t\t\t\t<div>Email: <input class="email" required name="email" value="').concat(this._user.email(),'"></div>\n\t\t\t\t<div>Address: <input class="address" required name="address" value="').concat(this._user.address(),'"></div>\n\t\t\t\t<div><input type="submit"></div>\n\t\t\t'),this._form.appendChild(this._buildLinkToList()),this._form.addEventListener("submit",(function(n){n.preventDefault();var r=e._form.querySelector(".id"),i=e._form.querySelector(".name"),s=e._form.querySelector(".email"),o=e._form.querySelector(".address"),a=new t(parseInt(r.value),i.value,s.value,o.value);e._updateUser(a)})),this._form},i.prototype._buildLinkToList=function(){var t=document.createElement("a");return t.innerHTML="to List",t.setAttribute("href","/"),t.addEventListener("click",(function(t){t.preventDefault(),e.trigger(new n("changePanel",new r("UserList")))})),t},i.prototype._updateUser=function(t){return e=this,n=void 0,i=function(){var e,n;return function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,(function(r){switch(r.label){case 0:return e={id:t.id(),name:t.name(),email:t.email(),address:t.address()},[4,fetch("/users/update/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return(n=r.sent()).ok?[4,n.json()]:[3,3];case 2:return r.sent(),alert("User updated"),[3,4];case 3:alert("Error HTTP: "+n.status),r.label=4;case 4:return[2]}}))},new((r=void 0)||(r=Promise))((function(t,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,a)}u((i=i.apply(e,n||[])).next())}));var e,n,r,i},i}();var a=function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};const c=function(){function c(){this._html=document.createElement("div"),this._html.className="user_panel",this._template="list"}return c.prototype.switchToListUsers=function(){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return this._clearHtml(),[4,this._listUsers()];case 1:return t.sent(),[2]}}))}))},c.prototype.switchToAddUser=function(){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return this._clearHtml(),[4,this._addUser()];case 1:return t.sent(),[2]}}))}))},c.prototype.switchToEditUser=function(){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return this._clearHtml(),[4,this._editUser()];case 1:return t.sent(),[2]}}))}))},c.prototype.buildHtmlElement=function(){return a(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this._html]}))}))},c.prototype._clearHtml=function(){this._html.innerHTML=""},c.prototype._listUsers=function(){return a(this,void 0,void 0,(function(){var t=this;return u(this,(function(e){switch(e.label){case 0:return[4,this._getUsers()];case 1:return e.sent().forEach((function(e){var n=new i(e);t._html.appendChild(n.buildHtmlElement())})),this._html.appendChild(this._buildHtmlButtonAdd()),this._html.appendChild(this._buildHtmlButtonDelete()),[2]}}))}))},c.prototype._addUser=function(){return a(this,void 0,void 0,(function(){var t;return u(this,(function(e){return t=new s,this._html.appendChild(t.buildHtmlElement()),[2]}))}))},c.prototype._editUser=function(){return a(this,void 0,void 0,(function(){var t,e;return u(this,(function(n){switch(n.label){case 0:return[4,this._getUser(1)];case 1:return t=n.sent(),e=new o(t),this._html.appendChild(e.buildHtmlElement()),[2]}}))}))},c.prototype._getUser=function(e){return a(this,void 0,void 0,(function(){var n,r,i,s;return u(this,(function(o){switch(o.label){case 0:return n={id:e},[4,fetch("/users/get-by-id/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})];case 1:return(i=o.sent()).ok?[4,i.json()]:[3,3];case 2:return s=o.sent(),r=new t(s.id,s.name,s.email,s.address),[3,4];case 3:alert("Error HTTP: "+i.status),o.label=4;case 4:return[2,r]}}))}))},c.prototype._getUsers=function(){return a(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){switch(r.label){case 0:return e=[],[4,fetch("/users/")];case 1:return(n=r.sent()).ok?[4,n.json()]:[3,3];case 2:return r.sent().forEach((function(n){var r=new t(n.id,n.name,n.email,n.address);e.push(r)})),[3,4];case 3:alert("Error HTTP: "+n.status),r.label=4;case 4:return[2,e]}}))}))},c.prototype._buildHtmlButtonAdd=function(){var t=document.createElement("button");return t.innerHTML="Add",t.addEventListener("click",(function(t){t.preventDefault(),e.trigger(new n("changePanel",new r("AddUser")))})),t},c.prototype._buildHtmlButtonDelete=function(){var t=this,e=document.createElement("button");return e.innerHTML="Delete",e.addEventListener("click",(function(e){t._deleteUsers()})),e},c.prototype._deleteUsers=function(){return a(this,void 0,void 0,(function(){var t,i,s;return u(this,(function(o){switch(o.label){case 0:return 0!==(t=document.querySelectorAll(".delete:checked")).length?[3,1]:[2];case 1:return i=[],t.forEach((function(t){i.push(parseInt(t.value))})),[4,fetch("/users/delete/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})];case 2:return(s=o.sent()).ok?[4,s.json()]:[3,4];case 3:return o.sent(),e.trigger(new n("changePanel",new r("UserList"))),[3,5];case 4:alert("Error HTTP: "+s.status),o.label=5;case 5:return[2]}}))}))},c}();var l=function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((r=r.apply(t,e||[])).next())}))},d=function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};const h=function(){function t(t){e.subscribe(this,"changePanel"),this._appContainer=document.querySelector(t),this._usersPanel=new c}return t.prototype.run=function(){return l(this,void 0,void 0,(function(){var t,e;return d(this,(function(n){switch(n.label){case 0:return[4,this._usersPanel.switchToListUsers()];case 1:return n.sent(),e=(t=this._appContainer).appendChild,[4,this._usersPanel.buildHtmlElement()];case 2:return e.apply(t,[n.sent()]),[2]}}))}))},t.prototype.invoke=function(t,e){return l(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:switch(e.data()){case"UserList":return[3,1];case"AddUser":return[3,3];case"EditUser":return[3,5]}return[3,7];case 1:return[4,this._usersPanel.switchToListUsers()];case 2:case 4:case 6:return t.sent(),[3,7];case 3:return[4,this._usersPanel.switchToAddUser()];case 5:return[4,this._usersPanel.switchToEditUser()];case 7:return[2]}}))}))},t}();window.onload=function(){return new h("#app").run()}})();
//# sourceMappingURL=app.js.map